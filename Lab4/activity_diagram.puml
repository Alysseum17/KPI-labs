@startuml
title Проходження тесту (Activity Diagram)

|User|
start
:Browse Quizzes;
:Select quiz;

:View quiz info;
  repeat
    :Click start button;
    :Start button clicked;
    note right: Signal: Start button clicked
    |QuizSystem|
    :Start button clicked;
    fork
        :Load questions;
    fork again
        :Create quiz attempt;
    fork again
        if (Start timer?) then (Yes)
            :Start timer;
        else (No)
        endif
    end fork
    
    repeat
        :Send question;
        note right: Data: Question
        
        |User|
        :Receive question;
        :Read question;
        :Select answer;
        :Answer selected;
        note right: Signal: Answer selected
        
        |QuizSystem|
        :Answer selected;
        :Save answer;
        :Calculate points;
        
    repeat while (More questions?) is (Yes)
    ->No;
    
    fork
        :Calculate total score;
    fork again
        :Save results;
    fork again
        :Update user quiz stats;
    end fork
    
    :Send results;
    note right: Data: Results
    
    |User|
    :View results;
    
repeat while (Want restart?) is (Yes) not (No);

if (Leave review?) then (Yes)
    :Rate quiz;
    :Write review;
    :Publish review;
    note right: Data: Review
    
    |QuizSystem|
    :Save review;
    :Review saved notification;
     note right: Signal: Review saved notification
    
    |User|
    :Review saved notification;
else (No)
endif

stop

@enduml
